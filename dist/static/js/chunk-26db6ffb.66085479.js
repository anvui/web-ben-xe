(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-26db6ffb"],{"02e1":function(t,e,i){},"08f3":function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return a}));var s={CANCELED:0,NEW:1,BOOKED:2,BOUGHT:3,ON_THE_TRIP:4,COMPLETED:5},a={TRIP:1,ROUTE:2,VEHICLE:3,COMPANY:4,KBUS:5}},"14ac":function(t,e,i){},"189d":function(t,e,i){},"267d":function(t,e,i){},"375d":function(t,e,i){"use strict";i("4e38")},"3ec5":function(t,e,i){"use strict";i("14ac")},"4d66":function(t,e,i){},"4e38":function(t,e,i){},5505:function(t,e,i){},5588:function(t,e,i){"use strict";i("189d")},"60e3":function(t,e,i){"use strict";i("5505")},"63d9":function(t,e,i){},"748c":function(t,e,i){},"779c":function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.token?i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingCalculatePrice,expression:"loadingCalculatePrice"}],staticClass:"create-trip-wrapper",style:{width:"CreateTrip"===t.$route.name?"80%":"100%"},attrs:{"element-loading-spinner":"el-icon-kbus-loading"}},[i("h4",{staticClass:"title"},[t._v("Đặt xe")]),i("div",{staticClass:"row no-gutters",staticStyle:{"margin-top":"40px",gap:"32px"}},[i("div",{staticClass:"col"},[i("div",{staticClass:"select-info"},[i("div",{staticClass:"info-item switch"},[i("span",{staticClass:"text-desc"},[t._v("Thuê nguyên chuyến")]),i("el-switch",{attrs:{"active-color":"#ED196B","inactive-color":"#ECEDF1"},model:{value:t.infoTrip.isOwned,callback:function(e){t.$set(t.infoTrip,"isOwned",e)},expression:"infoTrip.isOwned"}}),t.infoTrip.isOwned?i("span",{staticClass:"note-owned"},[t._v("Chuyến đi chắc chắn được khởi hành đúng với yêu cầu")]):i("span",{staticClass:"note-owned"},[t._v("Chuyến xe chỉ lăn bánh khi đủ lượng khách tối thiểu."),i("br"),t._v("Hãy chia sẻ để có thêm người đi cùng")])],1),i("div",{staticClass:"info-item"},[i("el-radio-group",{staticClass:"select-manual-route",model:{value:t.isSelectManualRoute,callback:function(e){t.isSelectManualRoute=e},expression:"isSelectManualRoute"}},[i("el-radio",{attrs:{label:1}},[t._v("Đi theo lộ trình riêng")]),i("el-radio",{attrs:{label:2}},[t._v("Đi theo lộ trình có sẵn")])],1)],1),2===t.isSelectManualRoute?i("div",{staticClass:"row no-gutters",staticStyle:{gap:"16px","margin-bottom":"16px"}},[i("div",{staticClass:"col-md"},[i("div",{staticClass:"info-item"},[i("label",{staticClass:"text-title"},[t._v("CHỌN NGÀY KHỞI HÀNH")]),i("el-date-picker",{staticClass:"w-100",attrs:{"picker-options":t.datePickerOptions,type:"date",format:"dd-MM-yyyy","value-format":"yyyy-MM-dd",placeholder:"Chọn ngày",clearable:!1},model:{value:t.infoTrip.date,callback:function(e){t.$set(t.infoTrip,"date",e)},expression:"infoTrip.date"}})],1)]),i("div",{staticClass:"col-md"},[i("div",{staticClass:"info-item"},[i("label",{staticClass:"text-title"},[t._v("CHỌN GIỜ KHỜI HÀNH")]),i("el-time-picker",{staticClass:"w-100",attrs:{format:"HH:mm","value-format":"HH:mm",placeholder:"Chọn giờ",clearable:!1},model:{value:t.infoTrip.time,callback:function(e){t.$set(t.infoTrip,"time",e)},expression:"infoTrip.time"}})],1)])]):t._e(),2===t.isSelectManualRoute?i("div",{staticClass:"info-item"},[i("label",{staticClass:"text-title"},[t._v("CHỌN TUYẾN")]),i("div",{directives:[{name:"show",rawName:"v-show",value:1===t.selectRouteType,expression:"selectRouteType === 1"}],attrs:{id:"available-route"}},[i("select-route",{ref:"SelectRoute",attrs:{placeholder:"Chọn tuyến"},model:{value:t.infoTrip.route,callback:function(e){t.$set(t.infoTrip,"route",e)},expression:"infoTrip.route"}})],1),i("div",{directives:[{name:"show",rawName:"v-show",value:2===t.selectRouteType,expression:"selectRouteType === 2"}],attrs:{id:"manual-route"}},[i("div",{staticClass:"row no-gutters"},[i("div",{staticClass:"col-xs-12 col-md"},[i("select-point",{ref:"ProvinceUp",staticClass:"pr-3",attrs:{placeholder:"Chiều đi","prefix-icon":"icon-bus","icon-size":16},model:{value:t.selectPoint.pointUp,callback:function(e){t.$set(t.selectPoint,"pointUp",e)},expression:"selectPoint.pointUp"}})],1),i("div",{staticClass:"col-xs-12 col-md-auto",staticStyle:{width:"32px"}},[i("div",{staticClass:"seperate"},[i("div",{staticClass:"icon-swap"},[i("svg",{attrs:{width:"56",height:"56",viewBox:"0 0 56 56",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[i("g",{attrs:{filter:"url(#filter0_d_4298_8874)"}},[i("circle",{attrs:{cx:"28",cy:"26",r:"16",fill:"white"}})]),i("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M28.6667 22.3335C28.6667 21.3684 29.3682 20.6668 30.3333 20.6668C31.2985 20.6668 32 21.3683 32 22.3335V28.0968C31.0362 28.3836 30.3333 29.2765 30.3333 30.3335C30.3333 31.6222 31.378 32.6668 32.6667 32.6668C33.9553 32.6668 35 31.6222 35 30.3335C35 29.2765 34.2972 28.3836 33.3333 28.0968V22.3335C33.3333 20.632 32.0349 19.3335 30.3333 19.3335C28.6318 19.3335 27.3333 20.632 27.3333 22.3335V29.6668C27.3333 30.632 26.6318 31.3335 25.6667 31.3335C24.7015 31.3335 24 30.632 24 29.6668V21.6096L24.5286 22.1382C24.7889 22.3986 25.2111 22.3986 25.4714 22.1382C25.7318 21.8779 25.7318 21.4558 25.4714 21.1954L23.8048 19.5288C23.6842 19.4082 23.5174 19.3335 23.3333 19.3335C23.2429 19.3335 23.1567 19.3515 23.0781 19.3841C22.9995 19.4166 22.9258 19.4648 22.8619 19.5288L21.1953 21.1954C20.9349 21.4558 20.9349 21.8779 21.1953 22.1382C21.4556 22.3986 21.8777 22.3986 22.1381 22.1382L22.6667 21.6096V29.6668C22.6667 31.3684 23.9651 32.6668 25.6667 32.6668C27.3682 32.6668 28.6667 31.3684 28.6667 29.6668V22.3335ZM32.6667 29.3335C32.1144 29.3335 31.6667 29.7812 31.6667 30.3335C31.6667 30.8858 32.1144 31.3335 32.6667 31.3335C33.219 31.3335 33.6667 30.8858 33.6667 30.3335C33.6667 29.7812 33.219 29.3335 32.6667 29.3335Z",fill:"#383F47"}}),i("path",{attrs:{d:"M32.6665 29.3335C32.1142 29.3335 31.6665 29.7812 31.6665 30.3335C31.6665 30.8858 32.1142 31.3335 32.6665 31.3335C33.2188 31.3335 33.6665 30.8858 33.6665 30.3335C33.6665 29.7812 33.2188 29.3335 32.6665 29.3335Z",fill:"#FBD1E1"}}),i("defs",[i("filter",{attrs:{id:"filter0_d_4298_8874",x:"0",y:"0",width:"56",height:"56",filterUnits:"userSpaceOnUse","color-interpolation-filters":"sRGB"}},[i("feFlood",{attrs:{"flood-opacity":"0",result:"BackgroundImageFix"}}),i("feColorMatrix",{attrs:{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}}),i("feOffset",{attrs:{dy:"2"}}),i("feGaussianBlur",{attrs:{stdDeviation:"6"}}),i("feColorMatrix",{attrs:{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"}}),i("feBlend",{attrs:{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_4298_8874"}}),i("feBlend",{attrs:{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_4298_8874",result:"shape"}})],1)])])])])]),i("div",{staticClass:"col-xs-12 col-md"},[i("select-point",{ref:"ProvinceDown",staticClass:"pl-3",attrs:{placeholder:"Chiều về","prefix-icon":"icon-local","icon-size":16},model:{value:t.selectPoint.pointDown,callback:function(e){t.$set(t.selectPoint,"pointDown",e)},expression:"selectPoint.pointDown"}})],1)])])]):t._e(),2===t.isSelectManualRoute&&t.infoTrip.route&&1===t.selectRouteType?i("div",{staticClass:"info-item"},[i("label",{staticClass:"text-title"},[t._v("CHỌN ĐIỂM LÊN, ĐIỂM XUỐNG")]),i("div",{staticClass:"list-point"},[i("div",{staticClass:"row no-gutters"},[i("div",{staticClass:"col-md-6"},[i("div",{attrs:{id:"point-up"}},[i("div",{staticClass:"w-100 text-center"},[i("label",{staticClass:"pb-1",class:{"label-active":"point-up"===t.pointActive},staticStyle:{margin:"0 auto"},on:{click:function(e){return t.getActivePoint("point-up")}}},[t._v("Điểm lên")])]),i("div",{staticClass:"select-place-address-wrapper",class:{disabled:"point-up"!==t.pointActive}},[i("div",{staticClass:"select-address"},[t.getRouteByRouteName?i("el-radio-group",{model:{value:t.infoTrip.pickUpAddress,callback:function(e){t.$set(t.infoTrip,"pickUpAddress",e)},expression:"infoTrip.pickUpAddress"}},[i("div",{staticClass:"w-100 list-address"},[t._l(t.getStartPoints,(function(e,s){return[i("el-radio",{key:s,attrs:{label:e.id}},[i("div",{staticClass:"w-100"},[i("span",{attrs:{id:"text-time-and-point"}},[t._v(" "+t._s(e.name)+" ")]),i("span",{attrs:{id:"text-detail-address"}},[t._v(" "+t._s(e.address)+" ")])])])]}))],2)]):i("div",{staticClass:"no-data"},[i("span",[t._v("Không tìm thấy dữ liệu")])])],1)])])]),i("div",{staticClass:"col-md-6"},[i("div",{attrs:{id:"point-down"}},[i("div",{staticClass:"w-100 text-center"},[i("label",{staticClass:"pb-1",class:{"label-active":"point-down"===t.pointActive},staticStyle:{margin:"0 auto"},on:{click:function(e){return t.getActivePoint("point-down")}}},[t._v("Điểm xuống")])]),i("div",{staticClass:"select-place-address-wrapper",class:{disabled:"point-down"!==t.pointActive}},[i("div",{staticClass:"select-address"},[t.getRouteByRouteName&&t.getRouteByRouteName.points?i("el-radio-group",{model:{value:t.infoTrip.pickDownAddress,callback:function(e){t.$set(t.infoTrip,"pickDownAddress",e)},expression:"infoTrip.pickDownAddress"}},[i("div",{staticClass:"w-100 list-address"},[t._l(t.getEndPoints,(function(e,s){return[i("el-radio",{key:s,attrs:{label:e.id}},[i("div",{staticClass:"w-100"},[i("span",{attrs:{id:"text-time-and-point"}},[t._v(" "+t._s(e.name)+" ")]),i("span",{attrs:{id:"text-detail-address"}},[t._v(" "+t._s(e.address)+" ")])])])]}))],2)]):i("div",{staticClass:"no-data"},[i("span",[t._v("Không tìm thấy dữ liệu")])])],1)])])])])])]):t._e(),1===t.isSelectManualRoute?i("div",{staticClass:"info-item"},[i("label",{staticClass:"text-title"},[t._v("THÔNG TIN LỘ TRÌNH")]),i("div",{staticClass:"list-places"},[t._l(t.listPlaces,(function(e,s){return[i("div",{key:s,staticClass:"place-item"},[i("div",{staticClass:"col-auto icon-remove-place-wrapper"},[i("el-button",{staticClass:"btn-remove-place",attrs:{icon:"el-icon-close",circle:""},on:{click:function(e){return t.handleRemovePlace(s)}}})],1),i("div",{staticClass:"col-md"},[i("div",{staticClass:"row no-gutters"},[i("div",{staticClass:"col-md"},[i("el-date-picker",{attrs:{type:"date",placeholder:"Chọn ngày khởi hành",format:"dd-MM-yyyy","value-format":"yyyy-MM-dd","picker-options":t.datePickerOptions,clearable:!1},on:{change:function(e){return t.handleDateTimeChange(s)}},model:{value:e.runDate,callback:function(i){t.$set(e,"runDate",i)},expression:"place.runDate"}})],1),i("div",{staticClass:"col-md",staticStyle:{"padding-left":"16px"}},[i("el-time-picker",{attrs:{placeholder:"Chọn giờ khởi hành",format:"HH:mm","value-format":"HH:mm",clearable:!1},on:{change:function(e){return t.handleDateTimeChange(s)}},model:{value:e.runTime,callback:function(i){t.$set(e,"runTime",i)},expression:"place.runTime"}})],1),i("div",{staticClass:"col-12",staticStyle:{"margin-top":"8px"}},[i("select-place",{ref:"SelectPlace",refInFor:!0,model:{value:e.place,callback:function(i){t.$set(e,"place",i)},expression:"place.place"}})],1)])])])]}))],2),i("div",{staticClass:"add-place"},[i("el-button",{staticClass:"btn-add-place"},[i("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M10.6663 8.5H5.33301C5.05967 8.5 4.83301 8.27333 4.83301 8C4.83301 7.72667 5.05967 7.5 5.33301 7.5H10.6663C10.9397 7.5 11.1663 7.72667 11.1663 8C11.1663 8.27333 10.9397 8.5 10.6663 8.5Z",fill:"#0091FE"}}),i("path",{attrs:{d:"M8 11.1668C7.72667 11.1668 7.5 10.9402 7.5 10.6668V5.3335C7.5 5.06016 7.72667 4.8335 8 4.8335C8.27333 4.8335 8.5 5.06016 8.5 5.3335V10.6668C8.5 10.9402 8.27333 11.1668 8 11.1668Z",fill:"#0091FE"}}),i("path",{attrs:{d:"M9.99967 15.1668H5.99967C2.37967 15.1668 0.833008 13.6202 0.833008 10.0002V6.00016C0.833008 2.38016 2.37967 0.833496 5.99967 0.833496H9.99967C13.6197 0.833496 15.1663 2.38016 15.1663 6.00016V10.0002C15.1663 13.6202 13.6197 15.1668 9.99967 15.1668ZM5.99967 1.8335C2.92634 1.8335 1.83301 2.92683 1.83301 6.00016V10.0002C1.83301 13.0735 2.92634 14.1668 5.99967 14.1668H9.99967C13.073 14.1668 14.1663 13.0735 14.1663 10.0002V6.00016C14.1663 2.92683 13.073 1.8335 9.99967 1.8335H5.99967Z",fill:"#0091FE"}})]),i("a",{staticClass:"text-add-place",attrs:{href:""},on:{click:function(e){return e.preventDefault(),t.handleAddPlace(e)}}},[t._v("Thêm lộ trình")])])],1)]):t._e(),i("div",{staticClass:"info-item"},[i("label",{staticClass:"text-title"},[t._v("CHỌN PHƯƠNG TIỆN")]),i("select-vehicle",{model:{value:t.infoTrip.vehicle,callback:function(e){t.$set(t.infoTrip,"vehicle",e)},expression:"infoTrip.vehicle"}})],1),t.infoTrip.vehicle?i("div",{staticClass:"info-item"},[i("label",{staticClass:"text-title"},[t._v("CHỌN SỐ LƯỢNG HÀNH KHÁCH")]),i("div",{staticClass:"row no-gutters justify-content-between"},[i("div",{staticClass:"col-md-6"},[i("el-input-number",{attrs:{value:t.totalPassengers,step:1,min:1,max:t.infoTrip.vehicle.totalSeat,disabled:!t.infoTrip.vehicle},on:{change:t.handlePassengersChange}})],1),i("div",{staticClass:"col-md-6"},[t.infoTrip.isOwned&&t.totalPassengers<t.infoTrip.vehicle.totalSeat?i("div",[i("el-checkbox",{staticClass:"checkbox-share-trip",model:{value:t.infoTrip.isPublic,callback:function(e){t.$set(t.infoTrip,"isPublic",e)},expression:"infoTrip.isPublic"}},[t._v("Chia sẻ cho người khách đi cùng để chắc chắn chuyến đi sẽ được khởi hành")])],1):t._e()]),t.infoTrip.isOwned?t._e():i("div",{staticClass:"col-12 mt-2"},[i("label",{staticClass:"text-title"},[t._v("SỐ GHẾ TỐI THIỂU")]),i("label",{staticClass:"min-seat-note"},[t._v("Số ghế tối thiểu để chuyến đi chắc chắn được khởi hành đúng yêu cầu")]),i("el-input-number",{attrs:{step:1,min:1,max:t.infoTrip.vehicle.totalSeat},model:{value:t.infoTrip.minSeat,callback:function(e){t.$set(t.infoTrip,"minSeat",e)},expression:"infoTrip.minSeat"}})],1)]),i("div",{staticClass:"customer-info-wrapper",style:{"padding-top":t.totalPassengers>0?"0.5rem":""}},[i("div",{style:{"border-bottom":t.totalPassengers>0?"1px solid #ECEDF1":""},attrs:{id:"list-label"}},[i("div",{staticClass:"nav"},[t._l(t.listIndexTotalPassengers,(function(e){return[i("div",{key:e,staticClass:"nav-item"},[i("label",{staticClass:"pb-1",class:{"label-active":t.labelFormCustomerActive===e},on:{click:function(i){return t.handelFormCustomerActive(e)}}},[t._v("HK"+t._s(e))]),1!==e?i("i",{staticClass:"el-icon-circle-close pl-1 pt-1",on:{click:function(i){return t.removeFormCustomer(e)}}}):t._e()])]}))],2)]),i("div",{attrs:{id:"form-customer-info"}},[t._l(t.listIndexTotalPassengers,(function(e){return[i("form-customer-info",{key:e,ref:"FormCustomerInfo",refInFor:!0,attrs:{"label-form-customer-active":t.labelFormCustomerActive},model:{value:t.infoTrip.customerInfos,callback:function(e){t.$set(t.infoTrip,"customerInfos",e)},expression:"infoTrip.customerInfos"}})]}))],2)])]):t._e(),i("div",{staticClass:"info-item"},[i("label",{staticClass:"text-title"},[t._v("GHI CHÚ")]),i("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"Nhập ghi chú của bạn"},model:{value:t.note,callback:function(e){t.note=e},expression:"note"}})],1)]),t._m(0),i("div",{staticClass:"create-trip-btn"},[i("el-button",{staticClass:"btn-create-trip",on:{click:t.handleConfirmPay}},[t._v("Xác nhận thanh toán")])],1)]),i("el-dialog",{attrs:{width:"30%",visible:t.dialogConfirmPay,"custom-class":"dialog-confirm-pay","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.dialogConfirmPay=e},open:t.handleOpen}},[i("div",{staticClass:"info-item"},[i("div",{staticClass:"time-countdown"},[i("span",[t._v("Thời gian thanh toán:")]),t.dialogConfirmPay?i("time-countdown",{ref:"TimeCountdown",attrs:{expire:t.timeExpire},on:{"pay-expire":t.payExpire}}):t._e()],1),i("div",{staticClass:"row no-gutters align-items-center"},[i("div",{staticClass:"col"},[i("span",[t._v("Chi phí tạm tính")])]),i("div",{staticClass:"col text-right"},[1===t.isSelectManualRoute&&t.priceManualCreate?i("span",{staticClass:"price-need-to-pay"},[t._v(t._s(t.numeral(t.priceManualCreate.totalMoneyPay).format(0,0))+"đ")]):2===t.isSelectManualRoute&&0!==t.priceAvailableCreate?i("span",{staticClass:"price-need-to-pay"},[t._v(t._s(t.numeral(t.priceAvailableCreate).format(0,0))+"đ")]):i("span",{staticClass:"price-need-to-pay"},[t._v(t._s(0)+"đ")])])]),i("div",{staticClass:"row no-gutters align-items-center"},[i("div",{staticClass:"col"},[1===t.isSelectManualRoute&&t.priceManualCreate?i("span",[t._v("Khoảng cách ("+t._s(t.$moment.utc(t.priceManualCreate.travelTime).format("H"))+"h "+t._s(t.$moment.utc(t.priceManualCreate.travelTime).format("mm"))+"p)")]):t._e(),2===t.isSelectManualRoute&&0!==t.priceAvailableCreate?i("span",[t._v("Khoảng cách ("+t._s(t.$moment.utc(t.getRouteByRouteName.finishTime).format("H"))+"h "+t._s(t.$moment.utc(t.getRouteByRouteName.finishTime).format("mm"))+"p)")]):t._e()]),i("div",{staticClass:"col text-right"},[1===t.isSelectManualRoute&&t.priceManualCreate?i("span",{staticClass:"price-need-to-pay"},[t._v("~ "+t._s(t.numeral(t.priceManualCreate.distance).format(0,0))+" km")]):2===t.isSelectManualRoute&&0!==t.priceAvailableCreate?i("span",{staticClass:"price-need-to-pay"},[t._v("~ "+t._s(t.numeral(t.getRouteByRouteName.distance).format(0,0))+" km")]):t._e()])]),0!==t.discountTicket?i("div",{staticClass:"row no-gutters align-items-center"},[i("div",{staticClass:"col"},[i("span",[t._v("Khuyến mãi VIP")])]),i("div",{staticClass:"col text-right"},[i("span",{staticClass:"price-need-to-pay"},[t._v(t._s("- "+t.numeral(t.discountTicket).format(0,0))+"đ")])])]):t._e(),i("div",{staticClass:"row no-gutters align-items-center"},[i("div",{staticClass:"col"},[i("span",[t._v("Còn lại")])]),i("div",{staticClass:"col text-right"},[i("span",{staticClass:"price-need-to-pay"},[t._v(t._s(t.numeral(t.remainPrice).format(0,0))+"đ")])])])]),i("div",{staticClass:"w-100 descriptions"},[i("span",[t._v("* Giá đã bao gồm VAT")])]),i("div",{staticClass:"form-invoice"},["OrderPage"===t.$route.name||"CreateTrip"===t.$route.name?i("el-checkbox",{model:{value:t.exportInvoice,callback:function(e){t.exportInvoice=e},expression:"exportInvoice"}},[t._v(" Lấy hoá đơn ")]):t._e(),t.exportInvoice?i("el-form",{ref:"invoice-info",attrs:{id:"form-invoice-info",model:t.invoiceInfo,rules:t.formInvoiceRules,"auto-complete":"on","label-position":"left"}},[i("el-form-item",{attrs:{prop:"companyName"}},[i("el-input",{ref:"companyName",staticClass:"form-input",attrs:{name:"companyName",type:"text"},model:{value:t.invoiceInfo.companyName,callback:function(e){t.$set(t.invoiceInfo,"companyName",e)},expression:"invoiceInfo.companyName"}}),i("label",{staticClass:"custom-placeholder"},[t._v("Tên công ty")])],1),i("el-form-item",{attrs:{prop:"address"}},[i("el-input",{ref:"address",staticClass:"form-input",attrs:{name:"address",type:"text"},model:{value:t.invoiceInfo.address,callback:function(e){t.$set(t.invoiceInfo,"address",e)},expression:"invoiceInfo.address"}}),i("label",{staticClass:"custom-placeholder"},[t._v("Địa chỉ")])],1),i("el-form-item",{attrs:{prop:"tax"}},[i("el-input",{ref:"tax",staticClass:"form-input",attrs:{name:"tax",type:"text"},model:{value:t.invoiceInfo.tax,callback:function(e){t.$set(t.invoiceInfo,"tax","string"===typeof e?e.trim():e)},expression:"invoiceInfo.tax"}}),i("label",{staticClass:"custom-placeholder"},[t._v("Mã số thuế")])],1),i("el-form-item",{attrs:{prop:"email"}},[i("el-input",{ref:"email",staticClass:"form-input",attrs:{name:"email",type:"email"},model:{value:t.invoiceInfo.email,callback:function(e){t.$set(t.invoiceInfo,"email","string"===typeof e?e.trim():e)},expression:"invoiceInfo.email"}}),i("label",{staticClass:"custom-placeholder"},[t._v("Email")])],1)],1):t._e()],1),i("div",{staticClass:"create-trip-btn"},[i("el-button",{staticClass:"btn-create-trip",class:t.isPayExpire?"disable":"",attrs:{loading:t.loadingCreateTrip},on:{click:t.handleCreateTrip}},[t._v("Thanh toán online")])],1)])],1)]):t._e()},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mt-3"},[i("span",{staticClass:"remind-to-customer"},[t._v(" Lưu ý: Hành khách cần có mặt trước tại các điểm đón ít nhất 10 phút ")])])}],n=i("5530"),o=(i("7db0"),i("d3b7"),i("4de4"),i("d81d"),i("a434"),i("4d63"),i("ac1f"),i("2c3e"),i("25f0"),i("00b4"),i("159b"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-autocomplete",{ref:"SelectPoint",staticClass:"w-100",attrs:{placeholder:t.placeholder,"fetch-suggestions":t.querySearch,"trigger-on-focus":!0,clearable:!1,"highlight-first-item":!1},on:{select:t.handleSelect,input:t.handleInput,focus:t.handleFocus},model:{value:t.searchRoute,callback:function(e){t.searchRoute=e},expression:"searchRoute"}},[i("span",{attrs:{slot:"prefix"},slot:"prefix"},[i("i",{staticClass:"el-icon-location el-input__icon"})])])}),r=[],l=i("1da1"),c=(i("caad"),i("2532"),i("96cf"),i("ed08")),u=i("2f62"),p={props:{value:{default:null,type:String},placeholder:{default:"",type:String}},data:function(){return{searchRoute:""}},computed:Object(n["a"])({},Object(u["c"])(["routes"])),watch:{value:function(t){this.searchRoute=t}},mounted:function(){this.getRoutes(),this.value&&(this.searchRoute=this.value)},methods:{getRoutes:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("route/getRoutes");case 2:case"end":return e.stop()}}),e)})))()},querySearch:function(t,e){var i=[];this.routes.forEach((function(t,e){i.push({value:t.routeName,label:t.id})}));var s=[];if(document.hasFocus())if(this.searchRoute!==this.value){var a=i.filter(this.createFilter(t));s=a}else s=i;e(s)},createFilter:function(t){return function(e){var i=Object(c["h"])(e.value.toLowerCase()),s=Object(c["h"])(t.toLowerCase());return i.includes(s)}},handleSelect:function(t){this.$emit("input",t.value)},handleInput:function(t){},handleFocus:function(t){t.target.select()}}},d=p,m=i("2877"),h=Object(m["a"])(d,o,r,!1,null,null,null),f=h.exports,v=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-select",{staticClass:"select-vehicle-wrapper",attrs:{value:t.value?t.value.brandName+" / "+t.value.totalSeat+" ghế":"",filterable:"",clearable:t.clearable,placeholder:t.placeholder,loading:t.loading,"loading-text":"Loading...","no-match-text":"Không có dữ liệu phù hợp","no-data-text":"Không có dữ liệu",remote:!0,"remote-method":t.remoteSearch},on:{change:t.handleChangeValue,"visible-change":t.handleVisibleChange}},[i("span",{attrs:{slot:"prefix"},slot:"prefix"},[i("span",{staticClass:"icon-input"},[i("svg",{attrs:{width:t.iconSize,height:t.iconSize,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3 4C2.46957 4 1.96086 4.21071 1.58579 4.58579C1.21071 4.96086 1 5.46957 1 6V17C1 17.5523 1.44772 18 2 18H3.17071C3.58254 19.1652 4.69378 20 6 20C7.30622 20 8.41746 19.1652 8.82929 18H15.1707C15.5825 19.1652 16.6938 20 18 20C19.3062 20 20.4175 19.1652 20.8293 18H22C22.5523 18 23 17.5523 23 17V12C23 9.96761 22.4257 7.97606 21.3493 6.46901C20.2698 4.95773 18.7207 4 17 4H3ZM11 6H8V9H11V6ZM13 9V6H15.1915L15.8344 9H13ZM3 11V16H3.17071C3.58254 14.8348 4.69378 14 6 14C7.30622 14 8.41746 14.8348 8.82929 16H15.1707C15.5825 14.8348 16.6938 14 18 14C19.3062 14 20.4175 14.8348 20.8293 16H21V13.0002H17.5C17.0284 13.0002 16.621 12.6708 16.5222 12.2097L16.2629 11H3ZM3 6H6V9H3V6ZM18.3084 11.0002H20.9429C20.7938 9.70509 20.3597 8.52454 19.7218 7.63149C18.9937 6.61221 18.0995 6.09249 17.2393 6.01132L18.3084 11.0002Z",fill:"#383F47"}})])])]),t._l(t.options,(function(e){return i("el-option",{key:e.id,staticClass:"vehicle-item",attrs:{value:e}},[t.vehicles.length>0?i("div",{staticClass:"d-flex",class:[t.value&&e.id===t.value.id?"selected":""]},[i("div",{staticClass:"col"},[t._v(" "+t._s(e.brandName)+" ")]),i("div",{staticClass:"col text-right"},[t._v(" "+t._s(e.totalSeat)+" chỗ HK ")])]):i("div",[i("span",[t._v("Không có dữ liệu")])])])}))],2)},g=[],C=(i("a9e3"),{props:{value:{default:null,type:Object},placeholder:{default:"Chọn phương tiện (nhập tên hoặc số chỗ)",type:String},clearable:{default:!1,type:Boolean},iconSize:{default:16,type:Number}},data:function(){return{loading:!1,options:[]}},computed:Object(n["a"])(Object(n["a"])({},Object(u["c"])(["vehicles"])),{},{getVehicle:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}),mounted:function(){this.getListVehicles()},methods:{getListVehicles:function(){var t=this;this.loading=!0,this.$store.dispatch("vehicle/listVehicles").then((function(e){t.loading=!1,t.options=t.vehicles})).catch((function(e){t.loading=!1,console.error(e),t.$message.error(e.message?e.message:"Đã có lỗi xảy ra")}))},handleChangeValue:function(t){this.getVehicle=t},remoteSearch:function(t){var e=this;t?(this.loading=!0,setTimeout((function(){e.loading=!1;var i=new RegExp("^[0-9]*$");i.test(t)?e.options=e.vehicles.filter((function(e){return e.totalSeat===parseInt(t)})):e.options=e.vehicles.filter((function(e){return e.model.toLowerCase().includes(t.toLowerCase())}))}),100)):this.options=this.vehicles},handleVisibleChange:function(t){var e=this;t||setTimeout((function(){e.options=e.vehicles}),100)}}}),b=C,T=(i("375d"),Object(m["a"])(b,v,g,!1,null,null,null)),I=T.exports,k=i("1bba"),_=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-autocomplete",{ref:"SelectPoint",staticClass:"w-100",attrs:{placeholder:t.placeholder,"fetch-suggestions":t.querySearch,"trigger-on-focus":!0,clearable:!1,"highlight-first-item":!1},on:{select:t.handleSelect,input:t.handleInput,focus:t.handleFocus},model:{value:t.searchPoint,callback:function(e){t.searchPoint=e},expression:"searchPoint"}},[i("div",{staticClass:"icon-prefix",attrs:{slot:"prefix"},slot:"prefix"},[i("div",{staticClass:"el-input__icon",class:t.prefixIcon,style:{height:t.iconSize+"px"}})])])},x=[],y={props:{value:{default:null,type:String},placeholder:{default:"",type:String},prefixIcon:{type:String,default:null},iconSize:{type:Number,default:32}},data:function(){return{searchPoint:""}},computed:Object(n["a"])({},Object(u["c"])(["provinces"])),watch:{value:function(t){this.searchPoint=t}},mounted:function(){this.getProvinces(),this.value&&(this.searchPoint=this.value)},methods:{getProvinces:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("route/getProvinces");case 2:case"end":return e.stop()}}),e)})))()},querySearch:function(t,e){var i=[];this.provinces.forEach((function(t,e){i.push({value:t.provinceName,label:t.id})}));var s=[];if(document.hasFocus())if(this.searchPoint!==this.value){var a=i.filter(this.createFilter(t));s=a}else s=i;e(s)},createFilter:function(t){return function(e){var i=Object(c["h"])(e.value?e.value.toLowerCase():""),s=Object(c["h"])(t.toLowerCase());return i.includes(s)}},handleSelect:function(t){this.$emit("input",t.value)},handleInput:function(t){},handleFocus:function(t){t.target.select()}}},w=y,P=(i("fa22"),Object(m["a"])(w,_,x,!1,null,"b21751f6",null)),S=P.exports,$=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-autocomplete",{ref:"SelectPlace",staticClass:"autocomplete-place",attrs:{"popper-class":"list-place-wrap","trigger-on-focus":!1,"fetch-suggestions":t.remoteSearch,debounce:600,placeholder:"Chọn điểm đón/trả"},on:{select:t.handleChangeValue,focus:t.handleFocus},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.item;return[i("span",[t._v(t._s(s.address))])]}}]),model:{value:t.querySearch,callback:function(e){t.querySearch=e},expression:"querySearch"}},[i("template",{slot:"prefix"},[i("span",{staticClass:"icon-input"},[i("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{d:"M11.9999 14.1699C9.86988 14.1699 8.12988 12.4399 8.12988 10.2999C8.12988 8.15994 9.86988 6.43994 11.9999 6.43994C14.1299 6.43994 15.8699 8.16994 15.8699 10.3099C15.8699 12.4499 14.1299 14.1699 11.9999 14.1699ZM11.9999 7.93994C10.6999 7.93994 9.62988 8.99994 9.62988 10.3099C9.62988 11.6199 10.6899 12.6799 11.9999 12.6799C13.3099 12.6799 14.3699 11.6199 14.3699 10.3099C14.3699 8.99994 13.2999 7.93994 11.9999 7.93994Z",fill:"#292D32"}}),i("path",{attrs:{d:"M11.9997 22.76C10.5197 22.76 9.02969 22.2 7.86969 21.09C4.91969 18.25 1.65969 13.72 2.88969 8.33C3.99969 3.44 8.26969 1.25 11.9997 1.25C11.9997 1.25 11.9997 1.25 12.0097 1.25C15.7397 1.25 20.0097 3.44 21.1197 8.34C22.3397 13.73 19.0797 18.25 16.1297 21.09C14.9697 22.2 13.4797 22.76 11.9997 22.76ZM11.9997 2.75C9.08969 2.75 5.34969 4.3 4.35969 8.66C3.27969 13.37 6.23969 17.43 8.91969 20C10.6497 21.67 13.3597 21.67 15.0897 20C17.7597 17.43 20.7197 13.37 19.6597 8.66C18.6597 4.3 14.9097 2.75 11.9997 2.75Z",fill:"#292D32"}})])])])],2)},M=[],R={props:{value:{default:null,type:Object},placeholder:{default:"Chọn điểm đón/trả",type:String},clearable:{default:!1,type:Boolean}},data:function(){return{loading:!1,options:null,loadingBtnSearchMore:!1,querySearch:"",timeout:null}},computed:Object(n["a"])(Object(n["a"])({},Object(u["c"])(["token","listPlaces"])),{},{getPlace:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}),mounted:function(){this.value&&(this.querySearch=this.value.address)},methods:{handleChangeValue:function(t){var e=this;t.lat&&t.lng&&t.province&&t.district||this.$store.dispatch("place/getPlaceDetails",{input:t.placeId}).then((function(e){t.lat=e.lat,t.lng=e.lng,t.province=e.province,t.district=e.district})).catch((function(t){console.log(t),e.$message.error(t.message?t.message:"Không tìm thấy tọa độ")})),this.querySearch=t.address,this.getPlace=t},remoteSearch:function(t,e){var i=this;t&&(this.querySearch=t,this.loading=!0,this.$store.dispatch("place/getPlaces",{input:t}).then((function(t){i.loading=!1,i.options=t,clearTimeout(i.timeout),i.timeout=setTimeout((function(){e(i.options)}),300),i.options.length<=0&&i.searchMorePlace()})).catch((function(t){i.loading=!1,console.log(t)})))},searchMorePlace:function(){var t=this;this.loading=!0,this.$store.dispatch("place/getMorePlaces",{input:this.querySearch}).then((function(e){t.loading=!1,e.forEach((function(e){t.options.push(e)}))})).catch((function(e){t.loading=!1,console.log(e)}))},handleFocus:function(t){t.target.select()}}},D=R,A=(i("3ec5"),Object(m["a"])(D,$,M,!1,null,null,null)),N=A.exports,O=i("cca5"),F={components:{SelectRoute:f,SelectVehicle:I,FormCustomerInfo:k["a"],SelectPoint:S,SelectPlace:N,TimeCountdown:O["a"]},data:function(){return{infoTrip:{route:null,date:this.$moment().add(1,"days").format("YYYY-MM-DD"),time:"",vehicle:null,pickUpAddress:null,pickDownAddress:null,customerInfos:[],isOwned:!0,isPublic:!1,minSeat:0},pointActive:"point-up",totalPassengers:1,listIndexTotalPassengers:[1],labelFormCustomerActive:1,loadingCreateTrip:!1,dialogConfirmPay:!1,selectRouteType:1,selectPoint:{pointUp:"",pointDown:""},listPlaces:[{place:null,runTime:"00:00",runDate:this.$moment().add(1,"days").format("YYYY-MM-DD")}],loadingCalculatePrice:!1,note:"",priceManualCreate:null,isSelectManualRoute:1,currentDate:this.$moment().format("YYYYMMDD"),datePickerOptions:{disabledDate:function(t){var e=new Date;return e.setDate(e.getDate()-1),t<=e}},exportInvoice:!1,invoiceInfo:{companyName:"",address:"",tax:"",email:""},formInvoiceRules:{},timeExpire:0,isPayExpire:!1}},computed:Object(n["a"])(Object(n["a"])({},Object(u["c"])(["routes","vehicles","dateAndPoint","respCreateTrip","validate","fillAllCustomer","firstCustomerInfo","token","provinces","userInfo","systemConfig"])),{},{getRouteByRouteName:function(){var t=this;if(this.infoTrip.route){var e=this.routes.find((function(e,i){return e.routeName===t.infoTrip.route}));return e}return null},findProvinceUp:function(){var t=this;return this.provinces.find((function(e,i){return e.provinceName===t.selectPoint.pointUp}))},findProvinceDown:function(){var t=this;return this.provinces.find((function(e,i){return e.provinceName===t.selectPoint.pointDown}))},getStartPoints:function(){var t=this;if(this.getRouteByRouteName&&this.getRouteByRouteName.points){var e=this.getRouteByRouteName.points.filter((function(e,i){return i!==t.getRouteByRouteName.points.length-1}));return e}return null},getEndPoints:function(){var t=this;if(this.getRouteByRouteName&&this.getRouteByRouteName.points){var e=this.getRouteByRouteName.points.filter((function(e,i){return 0!==i&&e.id!==t.infoTrip.pickUpAddress}));return e}return null},priceAvailableCreate:function(){var t=0,e=0;if(this.infoTrip.vehicle&&this.getRouteByRouteName?e=this.infoTrip.vehicle.minDistance?this.getRouteByRouteName.distance>this.infoTrip.vehicle.minDistance?this.getRouteByRouteName.distance:this.infoTrip.vehicle.minDistance:this.getRouteByRouteName.distance:t=0,2===this.isSelectManualRoute&&this.getRouteByRouteName&&this.infoTrip.vehicle){var i=e*this.infoTrip.vehicle.pricePerKm,s=this.infoTrip.minSeat;0===s&&(t=0),t=this.infoTrip.isOwned?parseInt(i*(1+this.getRouteByRouteName.profit)):parseInt(i*(1+this.getRouteByRouteName.profit)/s*this.totalPassengers)}return t},hasSelectedPlace:function(){var t=this.listPlaces.filter((function(t){return t.place}));return t},discountTicket:function(){var t=0;return this.userInfo.discountTicket?1===this.isSelectManualRoute&&this.priceManualCreate?t=this.priceManualCreate.totalMoneyPay*this.userInfo.discountTicket:2===this.isSelectManualRoute&&0!==this.priceAvailableCreate&&(t=this.priceAvailableCreate*this.userInfo.discountTicket):t=0,t},remainPrice:function(){var t=0;return 1===this.isSelectManualRoute&&this.priceManualCreate?t=this.priceManualCreate.totalMoneyPay-this.discountTicket:2===this.isSelectManualRoute&&0!==this.priceAvailableCreate&&(t=this.priceAvailableCreate-this.discountTicket),t},holderTime:function(){var t="";return t=this.infoTrip.isOwned?this.systemConfigData.tripHolderTime:this.systemConfigData.ticketHolderTime,t},systemConfigData:function(){var t=null;return this.systemConfig&&(t=JSON.parse(this.systemConfig.data)),t}}),watch:{listIndexTotalPassengers:function(t){this.totalPassengers=this.listIndexTotalPassengers.length},"infoTrip.pickUpAddress":function(t){t&&(this.pointActive="point-down")},"firstCustomerInfo.fullname":function(t){if(this.fillAllCustomer)for(var e=0;e<this.$refs.FormCustomerInfo.length;e++)this.$refs.FormCustomerInfo[e].customerInfo.fullname=t},"firstCustomerInfo.phoneNumber":function(t){if(this.fillAllCustomer)for(var e=0;e<this.$refs.FormCustomerInfo.length;e++)this.$refs.FormCustomerInfo[e].customerInfo.phoneNumber=t},"firstCustomerInfo.email":function(t){if(this.fillAllCustomer)for(var e=0;e<this.$refs.FormCustomerInfo.length;e++)this.$refs.FormCustomerInfo[e].customerInfo.email=t},"firstCustomerInfo.sex":function(t){if(this.fillAllCustomer)for(var e=0;e<this.$refs.FormCustomerInfo.length;e++)this.$refs.FormCustomerInfo[e].customerInfo.sex=t},"infoTrip.vehicle":function(t){this.infoTrip.minSeat=parseInt(60*t.totalSeat/100)}},mounted:function(){var t=this;if(this.$route.params.vehicle&&(this.infoTrip.vehicle=this.$route.params.vehicle),this.$route.params.bookFullTrip){this.infoTrip.vehicle=this.$route.params.bookFullTrip.vehicle,this.infoTrip.date=new Date(this.$route.params.bookFullTrip.startDate);var e=this.listPlaces.map((function(e){return{runDate:t.$moment(t.$route.params.bookFullTrip.startDate).format("YYYY-MM-DD"),runTime:"00:00",place:null}}));this.listPlaces=e}},methods:{getActivePoint:function(t){"point-up"===t&&(this.pointActive=t),"point-down"===t&&(this.infoTrip.pickUpAddress?this.pointActive=t:this.$message.error(this.$t("message.createTrip.selectPointUp")))},handlePassengersChange:function(t,e){var i,s=[];for(i=1;i<=t;i++)s.push(i);this.listIndexTotalPassengers=s,this.totalPassengers=this.listIndexTotalPassengers.length},handelFormCustomerActive:function(t){this.labelFormCustomerActive=t},removeFormCustomer:function(t){var e=this.listIndexTotalPassengers.indexOf(t);e>-1&&this.listIndexTotalPassengers.splice(e,1);var i=this.validate.filter((function(e){return e.index!==t}));this.$store.dispatch("trip/validateInfo",i)},changeRouteType:function(t){switch(t){case 1:this.selectPoint.pointUp="",this.selectPoint.pointDown="";break;case 2:this.infoTrip.route=null;break}},handleRemovePlace:function(t){this.listPlaces.splice(t,1)},handleAddPlace:function(){var t=this.listPlaces.length>0?this.listPlaces[this.listPlaces.length-1].runTime:this.$moment().add(1,"days").format("HH:mm"),e=this.listPlaces.length>0?this.listPlaces[this.listPlaces.length-1].runDate:this.$moment().add(1,"days").format("YYYY-MM-DD");this.listPlaces.push({place:null,runTime:t,runDate:e})},handleDateTimeChange:function(t){var e=this.listPlaces[0].runTime,i=this.listPlaces[0].runDate,s=this.listPlaces[t].runDate;if(0===t)for(var a=t+1;a<this.listPlaces.length;a++)this.listPlaces[a].runTime=e,this.listPlaces[a].runDate=i;for(var n=t+1;n<this.listPlaces.length;n++)this.listPlaces[n].runDate=s},validateInfoTrip:function(){return 1===this.isSelectManualRoute?this.infoTrip.vehicle?0===this.totalPassengers?(this.$message.error(this.$t("message.createTrip.selectNumberPassengers")),!1):this.validate.length>0?(this.$message.error(this.$t("message.createTrip.enterCorrectPassengerInfo")),!1):this.listPlaces.length<2?(this.$message.error(this.$t("message.createTrip.selectPlace")),!1):!(this.hasSelectedPlace.length<this.listPlaces.length)||(this.$message.error(this.$t("message.createTrip.enterFullPlace",{numberPlace:this.listPlaces.length})),!1):(this.$message.error(this.$t("message.createTrip.selectVehicle")),!1):1!==this.selectRouteType||this.infoTrip.route&&this.$refs.SelectRoute.searchRoute?2!==this.selectRouteType||this.pickUpAddress&&this.pickDownAddress?this.infoTrip.pickUpAddress?this.infoTrip.pickDownAddress?this.infoTrip.vehicle?0===this.totalPassengers?(this.$message.error(this.$t("message.createTrip.selectNumberPassengers")),!1):this.infoTrip.date?this.infoTrip.time?!(this.validate.length>0)||(this.$message.error(this.$t("message.createTrip.enterCorrectPassengerInfo")),!1):(this.$message.error(this.$t("message.createTrip.selectStartTime")),!1):(this.$message.error(this.$t("message.createTrip.selectStartDate")),!1):(this.$message.error(this.$t("message.createTrip.selectVehicle")),!1):(this.$message.error(this.$t("message.createTrip.selectPointDown")),!1):(this.$message.error(this.$t("message.createTrip.selectPointUp")),!1):(this.$message.error(this.$t("message.createTrip.selectPickUpandPickDown")),!1):(this.$message.error(this.$t("message.createTrip.selectRoute")),!1)},validateInvoiceInfo:function(){var t=new RegExp(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/);return this.exportInvoice&&!this.invoiceInfo.companyName?(this.$message.error(this.$t("message.createTrip.enterCompanyName")),!1):this.exportInvoice&&!this.invoiceInfo.address?(this.$message.error(this.$t("message.createTrip.enterAddress")),!1):this.exportInvoice&&!this.invoiceInfo.tax?(this.$message.error(this.$t("message.createTrip.enterTax")),!1):!!(!this.exportInvoice||this.invoiceInfo.email&&t.test(this.invoiceInfo.email))||(this.$message.error(this.$t("message.createTrip.enterEmail")),!1)},createAvailableTrip:function(){var t=this,e=[];if(this.$refs.FormCustomerInfo.forEach((function(t,i){if(0===t.validate.length&&t.customerInfo.fullname&&t.customerInfo.phoneNumber&&t.customerInfo.email&&t.customerInfo.sex){var s={fullName:t.customerInfo.fullname,phoneNumber:t.customerInfo.phoneNumber,email:t.customerInfo.email,sex:t.sexLabel[t.customerInfo.sex]};e.push(s)}})),this.infoTrip.customerInfos=e,this.infoTrip.customerInfos.length<this.totalPassengers)this.$message.error(this.$t("message.createTrip.enterFullCustomerInfo",{totalPassengers:this.totalPassengers}));else{var i=this.$moment(this.infoTrip.date).format("MM/DD/YYYY")+" "+this.infoTrip.time,s={routeId:this.getRouteByRouteName.id,pointUpId:this.infoTrip.pickUpAddress,pointDownId:this.infoTrip.pickDownAddress,vehicleId:this.infoTrip.vehicle.id,customerInfos:this.infoTrip.customerInfos,startTime:this.convertToIsoRunTime(i),isOwned:this.infoTrip.isOwned,isPublic:this.infoTrip.isPublic,note:this.note,minSeat:this.infoTrip.minSeat,exportInvoice:this.exportInvoice,invoiceInfo:this.exportInvoice?this.invoiceInfo:null};this.loadingCreateTrip=!0,setTimeout((function(){t.$store.dispatch("trip/createCustomerTrip",s).then((function(e){t.$store.dispatch("trip/getTripCode",{tripCode:t.respCreateTrip.customerTrip.tripCode}),t.loadingCreateTrip=!1,window.open(e.paymeUrlResponse.data.url,"_blank")})).catch((function(e){t.loadingCreateTrip=!1,console.log(e),t.$message.error(e.message?e.message:t.$t("message.common.undefinedError"))}))}),200)}},createManualTrip:function(){var t=this,e=[];if(this.$refs.FormCustomerInfo.forEach((function(t,i){if(0===t.validate.length&&t.customerInfo.fullname&&t.customerInfo.phoneNumber&&t.customerInfo.email&&t.customerInfo.sex){var s={fullName:t.customerInfo.fullname,phoneNumber:t.customerInfo.phoneNumber,email:t.customerInfo.email,sex:t.sexLabel[t.customerInfo.sex]};e.push(s)}})),this.infoTrip.customerInfos=e,this.infoTrip.customerInfos.length<this.totalPassengers)this.$message.error(this.$t("message.createTrip.enterFullCustomerInfo",{totalPassengers:this.totalPassengers}));else{var i=this.listPlaces.map((function(e){return Object(n["a"])(Object(n["a"])({},e.place),{},{runTime:new Date(t.$moment(e.runDate).format("MM/DD/YYYY")+" "+e.runTime).getTime()})})),s={vehicleId:this.infoTrip.vehicle.id,customerInfos:this.infoTrip.customerInfos,listPlace:i,isOwned:this.infoTrip.isOwned,isPublic:this.infoTrip.isPublic,note:this.note,runTime:this.convertToIsoRunTime(i[0].runTime),endTime:this.convertToIsoRunTime(i[i.length-1].runTime),numberTicket:this.totalPassengers,minSeat:this.infoTrip.minSeat,exportInvoice:this.exportInvoice,invoiceInfo:this.exportInvoice?this.invoiceInfo:null};this.loadingCreateTrip=!0,setTimeout((function(){t.$store.dispatch("trip/manualCreateCustomerTrip",s).then((function(e){t.loadingCreateTrip=!1,window.open(e.paymeUrlResponse.data.url,"_blank")})).catch((function(e){t.loadingCreateTrip=!1,console.log(e),t.$message.error(e.message?e.message:t.$t("message.common.undefinedError"))}))}),500)}},calculateManualPrice:function(){var t=this;if(this.validateInfoTrip()){var e=this.listPlaces.map((function(e){return Object(n["a"])(Object(n["a"])({},e.place),{},{runTime:new Date(t.$moment(e.runDate).format("MM/DD/YYYY")+" "+e.runTime).getTime()})})),i={vehicleId:this.infoTrip.vehicle.id,numberTicket:this.totalPassengers,listPlace:e,isOwned:this.infoTrip.isOwned,isPublic:this.infoTrip.isPublic,runTime:this.convertToIsoRunTime(e[0].runTime),endTime:this.convertToIsoRunTime(e[e.length-1].runTime),minSeat:this.infoTrip.minSeat};this.loadingCalculatePrice=!0,this.$store.dispatch("trip/priceManualCreate",i).then((function(e){t.loadingCalculatePrice=!1,t.priceManualCreate=e,t.dialogConfirmPay=!0})).catch((function(e){console.log(e),t.loadingCalculatePrice=!1,t.$message.error(e.message?e.message:t.$t("message.common.undefinedError"))}))}},handleConfirmPay:function(){1===this.isSelectManualRoute?this.calculateManualPrice():this.validateInfoTrip()&&(this.dialogConfirmPay=!0)},handleCreateTrip:function(){1===this.isSelectManualRoute?this.validateInvoiceInfo()&&this.createManualTrip():this.validateInvoiceInfo()&&this.createAvailableTrip()},convertToIsoRunTime:function(t){var e=new Date(t).toISOString();return e},payExpire:function(t){this.isPayExpire=!0},handleOpen:function(){this.isPayExpire&&(this.isPayExpire=!1),this.timeExpire=(new Date).getTime()+this.holderTime}}},H=F,E=(i("88da"),i("8985"),Object(m["a"])(H,s,a,!1,null,"fc7e5248",null));e["a"]=E.exports},8040:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.trip?i("div",{staticClass:"trip-item"},[i("div",{staticClass:"trip-item-info"},[i("div",{staticClass:"col-md-6 info-route"},[i("label",{staticClass:"title"},[t._v(t._s(t.$t("book.trip.timeLabel")))]),i("div",{staticClass:"run-time"},[i("div",{staticStyle:{"max-width":"120px"}},[i("div",{staticClass:"time"},[t._v(t._s(t.formatStartTime))]),i("div",{staticClass:"date"},[t._v(t._s(t.formatStartDate))]),t.trip.route&&t.trip.route.points?i("div",{staticClass:"address-point"},[t._v(t._s(t.trip.route.points[0].name))]):!t.trip.route&&t.getPointManual?i("div",{staticClass:"address-point"},[t._v(t._s(t.getPointManual[0].name))]):t._e()]),i("div",{staticClass:"distance"},[i("svg",{attrs:{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[i("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.15691 0.70942C3.31741 0.934126 3.26536 1.2464 3.04066 1.40691L1.29066 2.65691C1.06595 2.81741 0.753677 2.76536 0.593172 2.54066C0.432668 2.31595 0.484713 2.00368 0.70942 1.84317L2.45942 0.593172C2.68413 0.432668 2.9964 0.484713 3.15691 0.70942ZM8.84317 0.70942C9.00368 0.484713 9.31595 0.432668 9.54066 0.593172L11.2907 1.84317C11.5154 2.00368 11.5674 2.31595 11.4069 2.54066C11.2464 2.76536 10.9341 2.81741 10.7094 2.65691L8.95942 1.40691C8.73471 1.2464 8.68267 0.934126 8.84317 0.70942ZM0.916696 6.50005C0.916696 3.69258 3.19257 1.41671 6.00004 1.41671C8.80748 1.41671 11.0834 3.69258 11.0834 6.50005C11.0834 9.30749 8.80748 11.5834 6.00004 11.5834C3.19257 11.5834 0.916696 9.30749 0.916696 6.50005ZM6.00004 2.41671C3.74486 2.41671 1.9167 4.24487 1.9167 6.50005C1.9167 8.75521 3.74486 10.5834 6.00004 10.5834C8.2552 10.5834 10.0834 8.75521 10.0834 6.50005C10.0834 4.24487 8.2552 2.41671 6.00004 2.41671ZM5.93994 3.33843C6.21609 3.33846 6.43992 3.56234 6.43989 3.83848L6.43961 6.38354L8.23622 8.18015C8.43148 8.37541 8.43148 8.69199 8.23622 8.88725C8.04096 9.08252 7.72437 9.08252 7.52911 8.88725L5.58604 6.94418C5.49225 6.8504 5.43957 6.7232 5.43959 6.59057L5.43989 3.83837C5.43992 3.56223 5.6638 3.3384 5.93994 3.33843Z",fill:"white"}})]),t._v(" "+t._s(t.$t("book.trip.distanceTime",{hours:t.formatDistanceTime.hours,minutes:t.formatDistanceTime.minutes}))+" ")]),i("div",{staticStyle:{"max-width":"120px"}},[i("div",{staticClass:"time"},[t._v(t._s(t.formatEndTime))]),i("div",{staticClass:"date"},[t._v(t._s(t.formatEndDate))]),t.trip.route&&t.trip.route.points?i("div",{staticClass:"address-point"},[t._v(t._s(t.trip.route.points[t.trip.route.points.length-1].name))]):!t.trip.route&&t.getPointManual?i("div",{staticClass:"address-point"},[t._v(t._s(t.getPointManual[t.getPointManual.length-1].name))]):t._e()])]),i("div",{staticClass:"mt-1"},[t.trip.note?i("span",{staticClass:"trip-note"},[t._v("* "+t._s(t.trip.note))]):t._e()]),i("div",{staticClass:"btn-more-info mt-2"},[i("a",{attrs:{href:""},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.openMoreInfoSection(e)}}},[t._v(t._s(t.$t("book.trip.btnTripInfo")))])])]),i("div",{staticClass:"col info-company"},[t.trip.customerResponses&&t.trip.customerResponses.length>0?i("div",{staticClass:"user-created mt-3"},[i("span",{staticClass:"title"},[t._v(t._s(t.$t("book.trip.userCreated")))]),i("el-avatar",{staticClass:"avatar",attrs:{size:24,fit:"contain",icon:"el-icon-user-solid",src:t.trip.customerResponses[0].avatar}}),i("span",[t._v(t._s(t.trip.customerResponses[0].fullName))])],1):t._e()]),i("div",{staticClass:"col-auto info-price ml-auto"},[i("div",{staticClass:"border-wrap"},[i("span",{staticClass:"empty-seat"},[t._v(t._s(t.$t("book.trip.emptySeat"))+" "+t._s(t.trip.totalSeat))]),t.allowBookTicket&&t.trip.totalSeat>0?i("el-button",{staticClass:"btn-select-trip d-block",on:{click:function(e){return e.stopPropagation(),t.openSelectedTripSection(e)}}},[t._v(" "+t._s(t.selectedTripStatus===t.trip.tripId?t.$t("book.trip.btnClose"):t.$t("book.trip.btnBook"))+" ")]):t._e(),t.allowBookTicket?t._e():i("el-button",{staticClass:"btn-select-trip d-block ml-auto",class:{disabled:!t.allowBookTicket}},[t._v(" "+t._s(t.$t("book.trip.btnTimeout"))+" ")]),t.allowBookTicket&&t.trip.totalSeat<=0?i("el-button",{staticClass:"btn-select-trip d-block ml-auto",class:{disabled:t.trip.totalSeat<=0}},[t._v(" "+t._s(t.$t("book.trip.btnFullSeat"))+" ")]):t._e(),i("div",{staticClass:"text-right mt-1",staticStyle:{"margin-right":"20px"}})],1)])]),i("div",{staticClass:"more-info-section",class:[t.moreInfoStatus===t.trip.tripId?"":"collapsed"]},[i("more-info-trip",{attrs:{trip:t.trip}})],1),i("div",{staticClass:"selected-trip-section",class:[t.selectedTripStatus===t.trip.tripId?"":"collapsed"]},[i("selected-trip",{attrs:{trip:t.trip}})],1)]):t._e()},a=[],n=i("1da1"),o=i("5530"),r=(i("96cf"),i("a9e3"),i("fb6a"),i("99af"),i("ed08")),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"more-info-wrapper"},[i("ul",{staticClass:"nav"},[t._l(t.navItem,(function(e,s){return[i("li",{key:s,staticClass:"nav-item"},[i("a",{staticClass:"nav-link",class:{active:t.navActiveStatus===s+1},attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.setActive(s)}}},[t._v(t._s(e))])])]}))],2),1===t.navActiveStatus?i("div",{attrs:{id:"list-image"}},[t.trip.images?i("div",[i("hooper",{attrs:{settings:t.hooperSettings}},[t._l(t.trip.images,(function(e,s){return[i("slide",{key:s},[i("div",{staticClass:"row no-gutters justify-content-center"},[i("div",{staticClass:"col-auto"},[i("a",{attrs:{href:""},on:{click:function(i){return i.preventDefault(),t.handleShowImage(e)}}},[i("img",{attrs:{src:e,alt:"image/png"}})])])])])]})),i("hooper-navigation",{attrs:{slot:"hooper-addons"},slot:"hooper-addons"}),i("hooper-pagination",{attrs:{slot:"hooper-addons"},slot:"hooper-addons"})],2),i("span",{staticClass:"img-description"},[t._v(t._s(t.$t("book.moreInfoTrip.imagesDescription")))])],1):i("div",{staticClass:"w-100 text-center"},[t._v(t._s(t.$t("book.moreInfoTrip.noData")))])]):t._e(),2===t.navActiveStatus?i("div",{attrs:{id:"list-policy"}},[i("ul",[t._l(t.$t("book.moreInfoTrip.policyContent"),(function(e,s){return[i("li",{key:s},[t._v(t._s(e))])]}))],2)]):t._e(),3===t.navActiveStatus?i("div",{attrs:{id:"list-services"}},[t.trip.vehicle.services.length>0?i("div",{staticClass:"row no-gutters p-2",staticStyle:{gap:"16px"}},[t._l(t.trip.vehicle.services,(function(e,s){return[i("div",{key:s,staticClass:"col-auto text-center",staticStyle:{height:"24px"}},[i("div",{staticClass:"d-flex",staticStyle:{gap:"8px"}},[i("img",{attrs:{src:e.icon,alt:"image/png"}}),i("label",[t._v(t._s(e.name))])])])]}))],2):i("div",{staticClass:"w-100 text-center"},[t._v(t._s(t.$t("book.moreInfoTrip.noData")))])]):t._e(),4===t.navActiveStatus?i("div",{attrs:{id:"list-comments"}},[t.listComments.length>0?i("div",{directives:[{name:"loading",rawName:"v-loading"}]},[t._l(t.listComments,(function(e,s){return[i("div",{key:s,staticClass:"comment-item"},[i("div",{staticClass:"col-auto"},[i("el-avatar",{style:{background:e.createdBy.avatar?"transparent":"#C0C4CC"},attrs:{icon:"el-icon-user-solid",fit:"contain",src:e.createdBy.avatar,size:24}})],1),i("div",{staticClass:"col"},[i("div",{staticClass:"user-created"},[t._v(t._s(e.createdBy.fullName))]),i("el-rate",{staticClass:"mt-2",attrs:{value:e.rating,disabled:""}}),i("div",{staticClass:"content"},[t._v(t._s(e.content))]),i("div",{staticClass:"time-created"},[t._v(t._s(t.$moment(e.createdAt).format("DD/MM/YYYY HH:mm")))])],1)])]}))],2):i("div",{staticClass:"w-100 text-center"},[t._v(t._s(t.$t("book.moreInfoTrip.noData")))])]):t._e(),i("el-dialog",{attrs:{visible:t.dialog.status},on:{"update:visible":function(e){return t.$set(t.dialog,"status",e)}}},[i("img",{attrs:{src:t.dialog.imageUrl,alt:"image/png",width:"100%"}})])],1)},c=[],u=i("7e04"),p=(i("955f"),i("08f3")),d=i("2f62"),m={components:{Hooper:u["a"],Slide:u["d"],HooperNavigation:u["b"],HooperPagination:u["c"]},props:{trip:{type:Object,default:null}},data:function(){return{navItem:["Hình ảnh","Chính sách","Dịch vụ","Đánh giá"],navActiveStatus:1,hooperSettings:{infiniteScroll:!1,trimWhiteSpace:!0,wheelControl:!1,breakpoints:{1200:{itemsToShow:3},768:{itemsToShow:2},0:{itemsToShow:1}}},loadingRate:!1,dialog:{status:!1,imageUrl:""}}},computed:Object(o["a"])({},Object(d["c"])(["listComments"])),watch:{navActiveStatus:function(t){4===t&&this.getAllRate()}},methods:{setActive:function(t){this.navActiveStatus=t+1},getAllRate:function(){var t=this;this.loadingRate=!0,this.$store.dispatch("comment/getListComments",{type:p["a"].ROUTE,typeId:this.trip.route?this.trip.route.id:-1}).then((function(e){t.loadingRate=!1})).catch((function(e){t.loadingRate=!1,console.log(e),t.$message.error(e.message?e.message:t.$t("message.common.undefinedError"))}))},handleShowImage:function(t){this.dialog.status=!0,this.dialog.imageUrl=t}}},h=m,f=(i("ffb0"),i("60e3"),i("2877")),v=Object(f["a"])(h,l,c,!1,null,"46831c4b",null),g=v.exports,C=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"select-trip-wrapper"},[i("div",{staticClass:"select-point-up-point-down mt-3"},[i("h4",{staticClass:"text-title"},[t._v(t._s(t.$t("book.selectedTrip.title")))]),i("div",{staticClass:"list-point mt-3"},[i("div",{staticClass:"row no-gutters"},[i("div",{staticClass:"col-md-6"},[i("div",{attrs:{id:"point-up"}},[i("div",{staticClass:"w-100 text-center"},[i("label",{staticClass:"pb-1",class:{"label-active":"point-up"===t.pointActive},on:{click:function(e){return t.getActivePoint("point-up")}}},[t._v(t._s(t.$t("book.selectedTrip.pointUp")))])]),i("div",{staticClass:"select-place-address-wrapper",class:{disabled:"point-up"!==t.pointActive}},[i("div",{staticClass:"select-address"},[t.trip.route&&t.trip.route.points?i("el-radio-group",{model:{value:t.pickUpAddress,callback:function(e){t.pickUpAddress=e},expression:"pickUpAddress"}},[i("div",{staticClass:"address"},[t._l(t.getListPointUp,(function(e,s){return[i("el-radio",{key:s,attrs:{label:e.id}},[i("div",{staticClass:"w-100"},[i("span",{attrs:{id:"text-time-and-point"}},[t._v(" "+t._s(e.name)+" ")]),i("span",{attrs:{id:"text-detail-address"}},[t._v(" "+t._s(e.address)+" ")])])])]}))],2)]):t.getPointUpManual?i("el-radio-group",{model:{value:t.pickUpAddressManual,callback:function(e){t.pickUpAddressManual=e},expression:"pickUpAddressManual"}},[i("div",{staticClass:"address"},[t._l(t.getPointUpManual,(function(e,s){return[i("el-radio",{key:s,attrs:{label:e.placeId}},[i("div",{staticClass:"w-100"},[i("span",{attrs:{id:"text-time-and-point"}},[t._v(" "+t._s(e.name)+" ")]),i("span",{attrs:{id:"text-detail-address"}},[t._v(" "+t._s(e.address)+" ")])])])]}))],2)]):i("div",{staticClass:"no-data"},[i("span",[t._v(t._s(t.$t("book.selectedTrip.noData")))])])],1)])])]),i("div",{staticClass:"col-md-6"},[i("div",{attrs:{id:"point-down"}},[i("div",{staticClass:"w-100 text-center"},[i("label",{staticClass:"pb-1",class:{"label-active":"point-down"===t.pointActive},on:{click:function(e){return t.getActivePoint("point-down")}}},[t._v(t._s(t.$t("book.selectedTrip.pointDown")))])]),i("div",{staticClass:"select-place-address-wrapper",class:{disabled:"point-down"!==t.pointActive}},[i("div",{staticClass:"select-address"},[t.trip.route&&t.trip.route.points?i("el-radio-group",{model:{value:t.pickDownAddress,callback:function(e){t.pickDownAddress=e},expression:"pickDownAddress"}},[i("div",{staticClass:"w-100 address"},[t._l(t.getListPointDown,(function(e,s){return[i("el-radio",{key:s,attrs:{label:e.id}},[i("div",{staticClass:"w-100"},[i("span",{attrs:{id:"text-time-and-point"}},[t._v(" "+t._s(e.name)+" ")]),i("span",{attrs:{id:"text-detail-address"}},[t._v(" "+t._s(e.address)+" ")])])])]}))],2)]):t.getPointDownManual?i("el-radio-group",{model:{value:t.pickDownAddressManual,callback:function(e){t.pickDownAddressManual=e},expression:"pickDownAddressManual"}},[i("div",{staticClass:"w-100 address"},[t._l(t.getPointDownManual,(function(e,s){return[i("el-radio",{key:s,attrs:{label:e.placeId}},[i("div",{staticClass:"w-100"},[i("span",{attrs:{id:"text-time-and-point"}},[t._v(" "+t._s(e.name)+" ")]),i("span",{attrs:{id:"text-detail-address"}},[t._v(" "+t._s(e.address)+" ")])])])]}))],2)]):i("div",{staticClass:"no-data"},[i("span",[t._v(t._s(t.$t("book.selectedTrip.noData")))])])],1)])])])])])]),i("div",{staticClass:"select-number-passengers"},[i("div",{staticClass:"col-md-5"},[t._m(0),i("div",{directives:[{name:"loading",rawName:"v-loading",value:!t.selectedTrip||t.trip.tripId!==t.selectedTrip.trip.id||!t.seatMapFake,expression:"!selectedTrip ||\n          trip.tripId !== selectedTrip.trip.id ||\n          !seatMapFake"}],staticClass:"number-passengers-wrapper",attrs:{"element-loading-text":"Đợi xíu...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgb(255 255 255)"}},[i("div",{staticClass:"seat-map-placeholder"},t._l(t.seatMapFake,(function(e,s){return i("div",{key:s,staticClass:"seat-floor"},[i("label",{staticClass:"section-label justify-self-center"},[t._v(t._s("Tầng "+(s+1)))]),i("div",{staticClass:"seat-section"},t._l(e,(function(e,a){return i("div",{key:s+"."+a,staticClass:"seat-row"},t._l(e,(function(e,n){return i("div",{key:s+"."+a+"."+n,staticClass:"seat-col"},[i("div",{staticClass:"seat-item",class:[!e.seatId||3!==e.seatType&&4!==e.seatType?"seat-not-available":"seat-available",t.listSelectedSeat[e.seatId]?"seat-selected":""],attrs:{id:"seat-"+e.seatId},on:{click:function(i){return t.selectSeat(e)}}},[i("div",{staticClass:"seat-name"},[t._v(" "+t._s(e.seatId?e.seatId:"")+" ")])])])})),0)})),0)])})),0)])]),i("div",{staticClass:"col-md-7"},[i("div",{staticClass:"customer-info-wrapper",style:{padding:t.totalTicket>0?"0.5rem 1rem 0 1rem":""}},[i("div",{style:{"border-bottom":t.totalTicket>0?"1px solid #ECEDF1":""},attrs:{id:"list-label"}},[i("div",{staticClass:"nav"},[t._l(t.listIndexTotalPassengers,(function(e){return[i("div",{key:e,staticClass:"nav-item"},[i("label",{staticClass:"pb-1",class:{"label-active":t.labelFormCustomerActive===e},on:{click:function(i){return t.handelFormCustomerActive(e)}}},[t._v("Ghế "+t._s(e))]),1!==e?i("i",{staticClass:"el-icon-circle-close pl-1 pt-1",on:{click:function(i){return t.removeFormCustomer(e)}}}):t._e()])]}))],2)]),i("div",{attrs:{id:"form-customer-info"}},[t._l(t.listIndexTotalPassengers,(function(e){return[i("form-customer-info",{key:e,ref:"FormCustomerInfo",refInFor:!0,attrs:{"label-form-customer-active":t.labelFormCustomerActive,"trip-id":t.trip.tripId},model:{value:t.customerInfos,callback:function(e){t.customerInfos=e},expression:"customerInfos"}})]}))],2)])])]),i("div",{staticClass:"agree-terms-check"},[i("el-checkbox",{model:{value:t.agreeTermsStatus,callback:function(e){t.agreeTermsStatus=e},expression:"agreeTermsStatus"}},[t._v(" "+t._s(t.$t("book.selectedTrip.agreeTerms.label"))+" "),i("a",{attrs:{href:"#"}},[t._v(t._s(t.$t("book.selectedTrip.agreeTerms.policy")))])])],1),i("div",{staticClass:"form-invoice"},["OrderPage"===t.$route.name||"CreateTrip"===t.$route.name?i("el-checkbox",{model:{value:t.exportInvoice,callback:function(e){t.exportInvoice=e},expression:"exportInvoice"}},[t._v(" "+t._s(t.$t("book.selectedTrip.invoiceInfo.checkbox"))+" ")]):t._e(),t.exportInvoice?i("el-form",{ref:"invoice-info",attrs:{id:"form-invoice-info",model:t.invoiceInfo,rules:t.formInvoiceRules,"auto-complete":"on","label-position":"left"}},[i("el-form-item",{attrs:{prop:"companyName"}},[i("el-input",{ref:"companyName",staticClass:"form-input",attrs:{name:"companyName",type:"text"},model:{value:t.invoiceInfo.companyName,callback:function(e){t.$set(t.invoiceInfo,"companyName",e)},expression:"invoiceInfo.companyName"}}),i("label",{staticClass:"custom-placeholder"},[t._v(t._s(t.$t("book.selectedTrip.invoiceInfo.companyName")))])],1),i("el-form-item",{attrs:{prop:"address"}},[i("el-input",{ref:"address",staticClass:"form-input",attrs:{name:"address",type:"text"},model:{value:t.invoiceInfo.address,callback:function(e){t.$set(t.invoiceInfo,"address",e)},expression:"invoiceInfo.address"}}),i("label",{staticClass:"custom-placeholder"},[t._v(t._s(t.$t("book.selectedTrip.invoiceInfo.address")))])],1),i("el-form-item",{attrs:{prop:"tax"}},[i("el-input",{ref:"tax",staticClass:"form-input",attrs:{name:"tax",type:"text"},model:{value:t.invoiceInfo.tax,callback:function(e){t.$set(t.invoiceInfo,"tax","string"===typeof e?e.trim():e)},expression:"invoiceInfo.tax"}}),i("label",{staticClass:"custom-placeholder"},[t._v(t._s(t.$t("book.selectedTrip.invoiceInfo.taxNumber")))])],1),i("el-form-item",{attrs:{prop:"email"}},[i("el-input",{ref:"email",staticClass:"form-input",attrs:{name:"email",type:"email"},model:{value:t.invoiceInfo.email,callback:function(e){t.$set(t.invoiceInfo,"email","string"===typeof e?e.trim():e)},expression:"invoiceInfo.email"}}),i("label",{staticClass:"custom-placeholder"},[t._v(t._s(t.$t("book.selectedTrip.invoiceInfo.email")))])],1)],1):t._e()],1),i("div",{staticClass:"book-ticket-section"},[i("el-button",{staticClass:"btn-book-ticket",attrs:{loading:t.loadingBookTicket,disabled:!t.agreeTermsStatus},on:{click:t.handleBookTicket}},[t._v(t._s(t.$t("book.selectedTrip.btnBookTicket")))])],1)])},b=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"w-100 mt-3"},[i("h4",{staticClass:"text-title"},[t._v("Sơ đồ ghế (chọn ghế)")])])}],T=(i("4de4"),i("d3b7"),i("b64b"),i("4d63"),i("ac1f"),i("2c3e"),i("25f0"),i("00b4"),i("7db0"),i("159b"),i("d81d"),i("e9c4"),i("1bba")),I={components:{FormCustomerInfo:T["a"]},props:{trip:{type:Object,default:null}},data:function(){return{pointActive:"point-up",pickUpAddress:-1,pickDownAddress:-1,pickUpAddressManual:"",pickDownAddressManual:"",agreeTermsStatus:!0,totalPassengers:0,labelFormCustomerActive:1,loadingBookTicket:!1,customerInfos:[],listIndexTotalPassengers:[1],referralUser:"",exportInvoice:!1,invoiceInfo:{companyName:"",address:"",email:"",tax:""},formInvoiceRules:{},listSelectedSeat:{}}},computed:Object(o["a"])(Object(o["a"])({},Object(d["c"])(["promotionResponse","userInfo","validate","fillAllCustomer","firstCustomerInfo","selectedTrip","tripSeatMap","listPoint","searchTripQuery"])),{},{totalTicket:function(){var t=this.listIndexTotalPassengers.length;return t},seatMapFake:function(){var t=this.tripSeatMap?this.makeMapData(this.tripSeatMap):null;return t},getListPointUp:function(){var t=this,e=null;return this.trip.route&&(e=this.trip.route.points.filter((function(e,i){return i!==t.trip.route.points.length-1}))),e},getListPointDown:function(){var t=this,e=null;return this.trip.route&&(e=this.trip.route.points.filter((function(e,i){return 0!==i&&e.id!==t.pickUpAddress}))),e},routeProfit:function(){var t=.3;return this.trip.route&&(t=this.trip.route.profit),t},totalPrice:function(){var t=this.trip.baseTicketPrice*this.totalTicket;return t},discountPriceNow:function(){if(!this.trip.route||!this.trip.vehicle)return 0;var t=this.trip.route?this.trip.route.distance:this.trip.distance,e=this.trip.vehicle.minDistance?this.trip.vehicle.minDistance:0,i=parseInt(((e>t?e:t)*this.trip.vehicle.pricePerKm+this.trip.planTrip.additionMoney)*(1+this.routeProfit)),s=this.trip.numberTicketPaid+this.totalTicket,a=parseInt(i/s);return this.trip.baseTicketPrice>a?(this.trip.baseTicketPrice-a)*this.totalTicket:0},discountPriceMax:function(){if(!this.trip.route||!this.trip.vehicle)return 0;var t=parseInt((this.trip.route.distance*this.trip.vehicle.pricePerKm+this.trip.planTrip.additionMoney)*(1+this.routeProfit)),e=this.trip.totalSeat,i=parseInt(t/e),s=this.trip.baseTicketPrice;return 0===s&&(s=parseInt(t/e*60/100)),(s-i)*this.totalTicket},promotionDiscount:function(){var t=0;if(this.promotionResponse){var e=parseInt(this.totalPrice/this.totalTicket)*this.promotionResponse.discount;t=e<this.promotionResponse.maxDiscountValue?e*this.totalTicket:this.promotionResponse.maxDiscountValue*this.totalTicket}else t=0;return t+=this.discountTicket,t},remainPrice:function(){var t=this.trip.baseTicketPrice*this.totalTicket-this.discountPriceNow;return t},discountTicket:function(){var t=this.userInfo&&this.userInfo.discountTicket?this.totalPrice*this.userInfo.discountTicket:0;return t},getPointUpManual:function(){var t=null;if(this.trip.pointManual){var e=JSON.parse(this.trip.pointManual);t=e.filter((function(t,i){return i!==e.length-1}))}return t},getPointDownManual:function(){var t=this,e=null;if(this.trip.pointManual){var i=JSON.parse(this.trip.pointManual);e=i.filter((function(e,i){return 0!==i&&e.placeId!==t.pickUpAddress}))}return e}}),watch:{pickUpAddress:function(t){t&&(this.pointActive="point-down")},pickUpAddressManual:function(t){t&&(this.pointActive="point-down")},"firstCustomerInfo.fullname":function(t){if(this.fillAllCustomer)for(var e=0;e<this.$refs.FormCustomerInfo.length;e++)this.$refs.FormCustomerInfo[e].customerInfo.fullname=t},"firstCustomerInfo.phoneNumber":function(t){if(this.fillAllCustomer)for(var e=0;e<this.$refs.FormCustomerInfo.length;e++)this.$refs.FormCustomerInfo[e].customerInfo.phoneNumber=t},"firstCustomerInfo.email":function(t){if(this.fillAllCustomer)for(var e=0;e<this.$refs.FormCustomerInfo.length;e++)this.$refs.FormCustomerInfo[e].customerInfo.email=t},"firstCustomerInfo.sex":function(t){if(this.fillAllCustomer)for(var e=0;e<this.$refs.FormCustomerInfo.length;e++)this.$refs.FormCustomerInfo[e].customerInfo.sex=t}},created:function(){this.customerInfos.length>0&&(this.customerInfos=[]),this.$store.dispatch("promotion/resetPromotionResp")},mounted:function(){this.trip.route?(this.pickUpAddress=this.trip.route.points[0].id,this.pickDownAddress=this.trip.route.points[this.trip.route.points.length-1].id):(this.getPointUpManual||this.getPointDownManual)&&(this.pickUpAddressManual=this.getPointUpManual[0].placeId,this.pickDownAddressManual=this.getPointDownManual[this.getPointDownManual.length-1].placeId)},methods:{selectSeat:function(t){this.listSelectedSeat[t.seatId]?this.$delete(this.listSelectedSeat,t.seatId):this.$set(this.listSelectedSeat,t.seatId,t),1===Object.keys(this.listSelectedSeat).length&&(this.labelFormCustomerActive=t.seatId),this.listIndexTotalPassengers=Object.keys(this.listSelectedSeat)},handelFormCustomerActive:function(t){this.labelFormCustomerActive=t},getActivePoint:function(t){"point-up"===t&&(this.pointActive=t),"point-down"===t&&(this.pickUpAddress?this.pointActive=t:this.$message.error(this.$t("message.book.selectPointUp")))},validateCustomerInfo:function(){var t=new RegExp(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/);return this.pickUpAddress?this.pickDownAddress?this.validate.length>0?(this.$message.error(this.$t("message.book.enterCorrectPassengerInfo")),!1):this.exportInvoice&&!this.invoiceInfo.companyName?(this.$message.error(this.$t("message.book.enterCompanyName")),!1):this.exportInvoice&&!this.invoiceInfo.address?(this.$message.error(this.$t("message.book.enterAddress")),!1):this.exportInvoice&&!this.invoiceInfo.tax?(this.$message.error(this.$t("message.book.enterTax")),!1):!!(!this.exportInvoice||this.invoiceInfo.email&&t.test(this.invoiceInfo.email))||(this.$message.error(this.$t("message.book.enterEmail")),!1):(this.$message.error(this.$t("message.book.selectPointDown")),!1):(this.$message.error(this.$t("message.book.selectPointUp")),!1)},handleBookTicket:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){var i,s,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(t.listPoint),console.log(t.searchTripQuery),t.validateCustomerInfo()){e.next=4;break}return e.abrupt("return");case 4:if(i={tripId:t.selectedTrip.trip.id,platform:2,informationsBySeats:[]},s=t.listPoint.find((function(e){return e.pointId===t.searchTripQuery.startPoint})),a=t.listPoint.find((function(e){return e.pointId===t.searchTripQuery.endPoint})),t.$refs.FormCustomerInfo.map((function(t){return t.customerInfo})).forEach((function(e,n){var o={seatId:t.listIndexTotalPassengers[n],isAdult:!0,fullName:e.fullname,birthday:null,phoneNumber:e.phoneNumber,email:e.email,image:null,invoiceInfo:{requireStatus:1},note:null,paymentType:1,foreignKey:"",paidMoney:0,orderer:null,ordererPhoneNumber:null,pointUp:{pointType:0,name:s.pointName,id:s.pointId,address:s.address,transshipmentId:null},pointDown:{pointType:0,name:a.pointName,id:a.pointId,address:a.address,transshipmentId:null},overTime:null};i.informationsBySeats.push(o)})),console.log(i),t.customerInfos=i.informationsBySeats,!(t.customerInfos.length<t.totalPassengers)){e.next=13;break}return console.log("ko du thong tin khach"),e.abrupt("return");case 13:t.loadingBookTicket=!0,setTimeout((function(){t.$store.dispatch("system/bookTickets",i).then((function(e){t.$message.success(t.$t("message.book.bookTicketSuccess")),t.$router.push({name:"pay",query:{ticket:e.listTicket}}),t.$store.dispatch("system/setLastOrder",i),t.loadingBookTicket=!1})).catch((function(e){console.log(e),t.$message.error(e.message?e.message:t.$t("message.common.undefinedError")),t.loadingBookTicket=!1}))}),500);case 15:case"end":return e.stop()}}),e)})))()},handlePassengersChange:function(t,e){var i,s=[];for(i=1;i<=t;i++)s.push(i);this.listIndexTotalPassengers=s,this.totalPassengers=this.listIndexTotalPassengers.length},removeFormCustomer:function(t){this.$delete(this.listSelectedSeat,t),this.listIndexTotalPassengers=this.listIndexTotalPassengers.filter((function(e){return e!==t}));var e=this.validate.filter((function(e){return e.index!==t}));this.$store.dispatch("trip/validateInfo",e)},makeMapData:function(t){for(var e=this,i=[],s=0;s<t.numberOfFloors;s++){for(var a=[],n=0;n<t.numberOfRows;n++){for(var o=[],r=0;r<t.numberOfColumns;r++)o.push(e.makeSeatDefault(s+1,n+1,r+1));a.push(o)}i.push(a)}return t.seatList&&t.seatList.forEach((function(t){try{void 0!==i[t.floor-1][t.row-1][t.column-1]&&(i[t.floor-1][t.row-1][t.column-1]=t,i[t.floor-1][t.row-1][t.column-1].id="".concat(t.floor).concat(t.row).concat(t.column))}catch(e){console.log("ticket error"+JSON.stringify(t)+" (".concat(e,")"))}})),i},makeSeatDefault:function(t,e,i){var s={floor:t,column:i,row:e,seatId:null,seatType:7,seatStatus:1,extraPrice:0,id:"".concat(t).concat(e).concat(i)};return s}}},k=I,_=(i("5588"),i("f5de"),Object(f["a"])(k,C,b,!1,null,"78c262ad",null)),x=_.exports,y={components:{MoreInfoTrip:g,SelectedTrip:x},props:{trip:{default:null,type:Object},statusMoreInfoSection:{default:null,type:Number},statusSelectedTripSection:{default:null,type:[Number,String,Array]}},data:function(){return{userCreated:{size:24,avatar:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",name:"abcxyz"},dialogShareTrip:!1}},computed:Object(o["a"])(Object(o["a"])({},Object(d["c"])(["userInfo","token"])),{},{formatStartTime:function(){var t=this.$moment.utc(this.trip.startTime).format("HH:mm");return t},formatStartDate:function(){var t=this.trip.startDateReality.slice(0,4),e=this.trip.startDateReality.slice(4,6),i=this.trip.startDateReality.slice(6,9);return"".concat(i,"-").concat(e,"-").concat(t)},formatDistanceTime:function(){var t=Object(r["f"])(this.trip.finishTime||72e5);return t},formatEndTime:function(){var t="",e=this.$moment.utc(this.trip.startTime).format("YYYY/MM/DD HH:mm:ss"),i=new Date(e).getTime(),s=i+(this.trip.finishTime||72e5),a=this.$moment(s).format("HH:mm");return t=a,t},formatEndDate:function(){var t=this.trip.startDateReality.slice(0,4),e=this.trip.startDateReality.slice(4,6),i=this.trip.startDateReality.slice(6,9);return"".concat(i,"-").concat(e,"-").concat(t)},moreInfoStatus:{get:function(){return this.statusMoreInfoSection},set:function(t){this.$emit("set-status-more-info-section",t)}},selectedTripStatus:{get:function(){return this.statusSelectedTripSection},set:function(t){this.$emit("set-status-selected-trip-section",t)}},allowBookTicket:function(){return!0},getPointManual:function(){var t=null;return this.trip.pointManual&&(t=JSON.parse(this.trip.pointManual)),t}}),methods:{openMoreInfoSection:function(){if(this.selectedTripStatus&&(this.selectedTripStatus=null),this.moreInfoStatus&&this.moreInfoStatus===this.trip.tripId)return this.moreInfoStatus=null,!1;this.moreInfoStatus&&this.selectedTripStatus===this.trip.tripId||(this.moreInfoStatus=this.trip.tripId)},openSelectedTripSection:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.moreInfoStatus&&(t.moreInfoStatus=null),!t.selectedTripStatus||t.selectedTripStatus!==t.trip.tripId){e.next=6;break}return t.selectedTripStatus=null,e.abrupt("return",!1);case 6:t.selectedTripStatus&&t.moreInfoStatus===t.trip.tripId||(t.selectedTripStatus=t.trip.tripId);case 7:return console.log(t.trip),e.next=10,t.$store.dispatch("system/getTripDetail",t.trip.tripId);case 10:case"end":return e.stop()}}),e)})))()},shareTrip:function(){this.dialogShareTrip=!0}}},w=y,P=(i("8e1f"),i("d0fe"),Object(f["a"])(w,s,a,!1,null,"71bfaf85",null));e["a"]=P.exports},"83d1":function(t,e,i){},"88da":function(t,e,i){"use strict";i("63d9")},8985:function(t,e,i){"use strict";i("4d66")},"8e1f":function(t,e,i){"use strict";i("748c")},c472:function(t,e,i){},d0fe:function(t,e,i){"use strict";i("267d")},f5de:function(t,e,i){"use strict";i("83d1")},fa22:function(t,e,i){"use strict";i("c472")},ffb0:function(t,e,i){"use strict";i("02e1")}}]);